
package provaesame1;
import java.io.IOException;
import java.nio.file.Paths;
import java.util.*;

/**
 *
 * @author therealsimo24
 */
public class VulnerabilityScanner {

    public static void main(String[] args) throws IOException {
        
            Lista L = new Lista();
            
            System.out.print("La lista contiene ");
            leggiDaFile(L);
            L.stampa();
            
            ArrayList <Integer> arraylist = L.numberExploitable();
            int counterS = arraylist.get(0);
            int counterH = arraylist.get(1);
            
            System.out.println("\nIl numero di exploitable di SWVulnerability è di "+ counterS);
            System.out.println("Il numero di exploitable di HWVulnerability è di "+ counterH);
            
            L.removeNotExploitable();
            
            System.out.println("La lista senza elementi exploitable è: ");
            if(L.isEmpty()){
                System.out.println("La lista è vuota.");
            }else{
            L.stampa();
            }
            
            
    }
    
    public static void leggiDaFile(Lista L) throws IOException{
        
        Scanner input = new Scanner(Paths.get("Vulnerability.txt"));
        int dim = input.nextInt();
        System.out.println(dim+ " elementi:");
        for(int i = 0; i < dim; i++){
            String className;
            className = input.next();
            if(className.equals("provaesame1.HWVulnerability")){
                L.append(new HWVulnerability(input.next() , input.nextInt(), input.nextBoolean()));
            }else{
                L.append(new SWVulnerability(input.next() , input.nextInt(), input.nextInt(), input.nextBoolean()));
            }
        }
       
        input.close();
        
    }
    
    
}
